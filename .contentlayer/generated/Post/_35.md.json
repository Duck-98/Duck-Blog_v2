{
  "title": "createPortal을 이용한 커스텀 모달 만들기 with Next 14 app dir",
  "date": "2023-12-05",
  "description": "커스텀 모달, 훅 사용하기",
  "tag": "React",
  "body": {
    "raw": "\n### createPortal을 이용한 커스텀 모달 만들기 with Next 14 app dir\n\n#### Portal이란?\n\nPortal은 리액트 프로젝트에서 컴포넌트를 렌더링하게 될 때, UI 를 어디에 렌더링 시킬지 DOM을 사전에 선택하여 부모 컴포넌트의 바깥에 렌더링 할 수 있게 해주는 기능이다.\n그래서 모달 같이 최상단에 띄어줘야 할 때 사용하면 유용하다.\n\n우선, 해당 모달을 띄울 DOM을 만들어줘야한다.\n\nnext 환경이기 때문에 RootLayout에 만들어준다.\n\nbody 태그 안에  id가 \"modal-root\"인 div를 만들어줘서 해당 div으로 DOM을 선택할 수 있게 해준다.\n\n<br />\n\n```js\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"ko\" className=\"bg-gray-50\">\n      <body className=\"md:max-w-[375px] w-full relative m-auto min-h-screen bg-white p-0 font-sans lining-nums text-gray-900 outline-none\">\n        <div id=\"modal-root\" />\n        {children}\n        <ToastContainer position=\"top-right\" autoClose={5000} />\n      </body>\n    </html>\n  );\n}\n```\n\n<br />\n\n그리고, 모달 외부는 약간 어둡게 나와야하기때문에 모달 밖을 어둡게 해줄 BackDrop 컴포넌트를 만들어준다.\n\n<br />\n\n```js\n'use client';\ninterface BackdropProps {\n  isOpen: boolean;\n  onClick: () => void;\n}\n\nexport default function Backdrop({ isOpen, onClick }: BackdropProps) {\n  return (\n    <div\n      hidden={!isOpen}\n      onClick={onClick}\n      className={`${isOpen ? '' : 'hidden'} fixed inset-0 z-50 h-full w-full bg-black opacity-50`}\n    />\n  );\n}\n```\n\n그리고 모달 컴포넌트를 만들어준다. 여기에서 createPortal을 사용해주는데, 우리가 아까 만들었던 div를 선택해주기 위해서 getElementById를 이용해서 해당 div을 선택해준다.\n그리고 createPortal을 사용할 때 선택한 DOM id를 넣어준다.\n\n<br />\n\n```js\n'use client';\n\nimport { useState, useEffect, PropsWithChildren } from 'react';\nimport { createPortal } from 'react-dom';\nimport Backdrop from './Backdrop';\n\nexport default function Modal({\n  children,\n  isOpen,\n  onClose,\n  style,\n  className,\n}: PropsWithChildren<any>) {\n  const [mounted, setMounted] = useState(false);\n  const modalRoot = document.getElementById('modal-root') || document.body;\n\n  useEffect(() => setMounted(true), []);\n\n  return mounted\n    ? createPortal(\n        <>\n          <Backdrop isOpen={isOpen} onClick={onClose} />\n          <div\n            hidden={!isOpen}\n            style={{ ...style, display: isOpen ? undefined : 'none' }}\n            className={`fixed inset-0 top-56 z-50 mx-auto h-fit w-10/12 overflow-y-auto rounded-lg bg-white md:max-w-[375px] ${className}`}\n          >\n            {children}\n          </div>\n        </>,\n        modalRoot,\n      )\n    : null;\n}\n```\n\n<br />\n\n이제 커스텀 훅을 이용해서 모달을 조작하기 편하게 해줄 것이다.\n모달은 단순히 화면에 오픈되거나, 모달이 닫히거나 하는 역할만 해주면 되기 때문에 모달을 오픈해주는 함수, 모달을 닫아주는 함수, 모달의 상태값만 있으면 된다.\n\n<br />\n\n```js\n'use client';\nimport React, { useState } from 'react';\n\nconst useModal = () => {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const openModal = () => setIsOpen(true);\n  const closeModal = () => setIsOpen(false);\n\n  return { isOpen, openModal, closeModal };\n};\n\nexport default useModal;\n```\n\n<br />\n\n이런식으로 커스텀 훅을 만들어주면 모달을 사용할 때마다 useState로 상태를 만들어주지 않아도 되기 때문에 편하다.\n이제 해당 모달을 사용해보자!\n\n<br />\n\n```js\nexport default function PetInfoPage() {\n  const { isOpen, openModal, closeModal } = useModal();\n  return (\n    <>\n      <Modal isOpen={isOpen} onClose={closeModal}>\n        <div className=\"p-10 flex items-center justify-center flex-col\">\n          <span className=\"p-10\">테스트 모달입니다!</span>\n          <div className=\"flex\">\n            <button onClick={closeModal}>닫기</button>\n          </div>\n        </div>\n      </Modal>\n      <label onClick={openModal}>종 </label>\n      ....생략\n    </>\n  );\n}\n```\n\n**실행 화면**\n<Image src='/blog/35.gif' width='200' height={800}/>\n",
    "code": "var Component=(()=>{var p=Object.create;var r=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var g=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),x=(t,n)=>{for(var o in n)r(t,o,{get:n[o],enumerable:!0})},s=(t,n,o,l)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let a of m(n))!f.call(t,a)&&a!==o&&r(t,a,{get:()=>n[a],enumerable:!(l=u(n,a))||l.enumerable});return t};var b=(t,n,o)=>(o=t!=null?p(h(t)):{},s(n||!t||!t.__esModule?r(o,\"default\",{value:t,enumerable:!0}):o,t)),M=t=>s(r({},\"__esModule\",{value:!0}),t);var d=g((w,i)=>{i.exports=_jsx_runtime});var v={};x(v,{default:()=>k,frontmatter:()=>O});var e=b(d()),O={title:\"createPortal\\uC744 \\uC774\\uC6A9\\uD55C \\uCEE4\\uC2A4\\uD140 \\uBAA8\\uB2EC \\uB9CC\\uB4E4\\uAE30\\xA0with Next 14 app dir\",date:new Date(17017344e5),description:\"\\uCEE4\\uC2A4\\uD140 \\uBAA8\\uB2EC, \\uD6C5 \\uC0AC\\uC6A9\\uD558\\uAE30\",tag:\"React\"};function c(t){let n=Object.assign({h3:\"h3\",h4:\"h4\",p:\"p\",pre:\"pre\",code:\"code\",strong:\"strong\"},t.components),{Image:o}=n;return o||N(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h3,{children:\"createPortal\\uC744 \\uC774\\uC6A9\\uD55C \\uCEE4\\uC2A4\\uD140 \\uBAA8\\uB2EC \\uB9CC\\uB4E4\\uAE30\\xA0with Next 14 app dir\"}),`\n`,(0,e.jsx)(n.h4,{children:\"Portal\\uC774\\uB780?\"}),`\n`,(0,e.jsx)(n.p,{children:`Portal\\uC740 \\uB9AC\\uC561\\uD2B8 \\uD504\\uB85C\\uC81D\\uD2B8\\uC5D0\\uC11C \\uCEF4\\uD3EC\\uB10C\\uD2B8\\uB97C \\uB80C\\uB354\\uB9C1\\uD558\\uAC8C \\uB420 \\uB54C, UI \\uB97C \\uC5B4\\uB514\\uC5D0 \\uB80C\\uB354\\uB9C1 \\uC2DC\\uD0AC\\uC9C0 DOM\\uC744 \\uC0AC\\uC804\\uC5D0 \\uC120\\uD0DD\\uD558\\uC5EC \\uBD80\\uBAA8 \\uCEF4\\uD3EC\\uB10C\\uD2B8\\uC758 \\uBC14\\uAE65\\uC5D0 \\uB80C\\uB354\\uB9C1 \\uD560 \\uC218 \\uC788\\uAC8C \\uD574\\uC8FC\\uB294 \\uAE30\\uB2A5\\uC774\\uB2E4.\n\\uADF8\\uB798\\uC11C \\uBAA8\\uB2EC \\uAC19\\uC774 \\uCD5C\\uC0C1\\uB2E8\\uC5D0 \\uB744\\uC5B4\\uC918\\uC57C \\uD560 \\uB54C \\uC0AC\\uC6A9\\uD558\\uBA74 \\uC720\\uC6A9\\uD558\\uB2E4.`}),`\n`,(0,e.jsx)(n.p,{children:\"\\uC6B0\\uC120, \\uD574\\uB2F9 \\uBAA8\\uB2EC\\uC744 \\uB744\\uC6B8 DOM\\uC744 \\uB9CC\\uB4E4\\uC5B4\\uC918\\uC57C\\uD55C\\uB2E4.\"}),`\n`,(0,e.jsx)(n.p,{children:\"next \\uD658\\uACBD\\uC774\\uAE30 \\uB54C\\uBB38\\uC5D0 RootLayout\\uC5D0 \\uB9CC\\uB4E4\\uC5B4\\uC900\\uB2E4.\"}),`\n`,(0,e.jsx)(n.p,{children:'body \\uD0DC\\uADF8 \\uC548\\uC5D0\\xA0 id\\uAC00 \"modal-root\"\\uC778 div\\uB97C \\uB9CC\\uB4E4\\uC5B4\\uC918\\uC11C \\uD574\\uB2F9 div\\uC73C\\uB85C DOM\\uC744 \\uC120\\uD0DD\\uD560 \\uC218 \\uC788\\uAC8C \\uD574\\uC900\\uB2E4.'}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`export default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"ko\" className=\"bg-gray-50\">\n      <body className=\"md:max-w-[375px] w-full relative m-auto min-h-screen bg-white p-0 font-sans lining-nums text-gray-900 outline-none\">\n        <div id=\"modal-root\" />\n        {children}\n        <ToastContainer position=\"top-right\" autoClose={5000} />\n      </body>\n    </html>\n  );\n}\n`})}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0, \\uBAA8\\uB2EC \\uC678\\uBD80\\uB294 \\uC57D\\uAC04 \\uC5B4\\uB461\\uAC8C \\uB098\\uC640\\uC57C\\uD558\\uAE30\\uB54C\\uBB38\\uC5D0 \\uBAA8\\uB2EC \\uBC16\\uC744 \\uC5B4\\uB461\\uAC8C \\uD574\\uC904 BackDrop \\uCEF4\\uD3EC\\uB10C\\uD2B8\\uB97C \\uB9CC\\uB4E4\\uC5B4\\uC900\\uB2E4.\"}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`'use client';\ninterface BackdropProps {\n  isOpen: boolean;\n  onClick: () => void;\n}\n\nexport default function Backdrop({ isOpen, onClick }: BackdropProps) {\n  return (\n    <div\n      hidden={!isOpen}\n      onClick={onClick}\n      className={\\`\\${isOpen ? '' : 'hidden'} fixed inset-0 z-50 h-full w-full bg-black opacity-50\\`}\n    />\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:`\\uADF8\\uB9AC\\uACE0 \\uBAA8\\uB2EC \\uCEF4\\uD3EC\\uB10C\\uD2B8\\uB97C \\uB9CC\\uB4E4\\uC5B4\\uC900\\uB2E4. \\uC5EC\\uAE30\\uC5D0\\uC11C createPortal\\uC744 \\uC0AC\\uC6A9\\uD574\\uC8FC\\uB294\\uB370, \\uC6B0\\uB9AC\\uAC00 \\uC544\\uAE4C \\uB9CC\\uB4E4\\uC5C8\\uB358 div\\uB97C \\uC120\\uD0DD\\uD574\\uC8FC\\uAE30 \\uC704\\uD574\\uC11C getElementById\\uB97C \\uC774\\uC6A9\\uD574\\uC11C \\uD574\\uB2F9 div\\uC744 \\uC120\\uD0DD\\uD574\\uC900\\uB2E4.\n\\uADF8\\uB9AC\\uACE0 createPortal\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C \\uC120\\uD0DD\\uD55C DOM id\\uB97C \\uB123\\uC5B4\\uC900\\uB2E4.`}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`'use client';\n\nimport { useState, useEffect, PropsWithChildren } from 'react';\nimport { createPortal } from 'react-dom';\nimport Backdrop from './Backdrop';\n\nexport default function Modal({\n  children,\n  isOpen,\n  onClose,\n  style,\n  className,\n}: PropsWithChildren<any>) {\n  const [mounted, setMounted] = useState(false);\n  const modalRoot = document.getElementById('modal-root') || document.body;\n\n  useEffect(() => setMounted(true), []);\n\n  return mounted\n    ? createPortal(\n        <>\n          <Backdrop isOpen={isOpen} onClick={onClose} />\n          <div\n            hidden={!isOpen}\n            style={{ ...style, display: isOpen ? undefined : 'none' }}\n            className={\\`fixed inset-0 top-56 z-50 mx-auto h-fit w-10/12 overflow-y-auto rounded-lg bg-white md:max-w-[375px] \\${className}\\`}\n          >\n            {children}\n          </div>\n        </>,\n        modalRoot,\n      )\n    : null;\n}\n`})}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.p,{children:`\\uC774\\uC81C \\uCEE4\\uC2A4\\uD140 \\uD6C5\\uC744 \\uC774\\uC6A9\\uD574\\uC11C \\uBAA8\\uB2EC\\uC744 \\uC870\\uC791\\uD558\\uAE30 \\uD3B8\\uD558\\uAC8C \\uD574\\uC904 \\uAC83\\uC774\\uB2E4.\n\\uBAA8\\uB2EC\\uC740 \\uB2E8\\uC21C\\uD788 \\uD654\\uBA74\\uC5D0 \\uC624\\uD508\\uB418\\uAC70\\uB098, \\uBAA8\\uB2EC\\uC774 \\uB2EB\\uD788\\uAC70\\uB098 \\uD558\\uB294 \\uC5ED\\uD560\\uB9CC \\uD574\\uC8FC\\uBA74 \\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uBAA8\\uB2EC\\uC744 \\uC624\\uD508\\uD574\\uC8FC\\uB294 \\uD568\\uC218, \\uBAA8\\uB2EC\\uC744 \\uB2EB\\uC544\\uC8FC\\uB294 \\uD568\\uC218, \\uBAA8\\uB2EC\\uC758 \\uC0C1\\uD0DC\\uAC12\\uB9CC \\uC788\\uC73C\\uBA74 \\uB41C\\uB2E4.`}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`'use client';\nimport React, { useState } from 'react';\n\nconst useModal = () => {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const openModal = () => setIsOpen(true);\n  const closeModal = () => setIsOpen(false);\n\n  return { isOpen, openModal, closeModal };\n};\n\nexport default useModal;\n`})}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.p,{children:`\\uC774\\uB7F0\\uC2DD\\uC73C\\uB85C \\uCEE4\\uC2A4\\uD140 \\uD6C5\\uC744 \\uB9CC\\uB4E4\\uC5B4\\uC8FC\\uBA74 \\uBAA8\\uB2EC\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB9C8\\uB2E4 useState\\uB85C \\uC0C1\\uD0DC\\uB97C \\uB9CC\\uB4E4\\uC5B4\\uC8FC\\uC9C0 \\uC54A\\uC544\\uB3C4 \\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uD3B8\\uD558\\uB2E4.\n\\uC774\\uC81C \\uD574\\uB2F9 \\uBAA8\\uB2EC\\uC744 \\uC0AC\\uC6A9\\uD574\\uBCF4\\uC790!`}),`\n`,(0,e.jsx)(\"br\",{}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-js\",children:`export default function PetInfoPage() {\n  const { isOpen, openModal, closeModal } = useModal();\n  return (\n    <>\n      <Modal isOpen={isOpen} onClose={closeModal}>\n        <div className=\"p-10 flex items-center justify-center flex-col\">\n          <span className=\"p-10\">\\uD14C\\uC2A4\\uD2B8 \\uBAA8\\uB2EC\\uC785\\uB2C8\\uB2E4!</span>\n          <div className=\"flex\">\n            <button onClick={closeModal}>\\uB2EB\\uAE30</button>\n          </div>\n        </div>\n      </Modal>\n      <label onClick={openModal}>\\uC885 </label>\n      ....\\uC0DD\\uB7B5\n    </>\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\uC2E4\\uD589 \\uD654\\uBA74\"})}),`\n`,(0,e.jsx)(o,{src:\"/blog/35.gif\",width:\"200\",height:800})]})}function y(t={}){let{wrapper:n}=t.components||{};return n?(0,e.jsx)(n,Object.assign({},t,{children:(0,e.jsx)(c,t)})):c(t)}var k=y;function N(t,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+t+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return M(v);})();\n;return Component;"
  },
  "_id": "35.md",
  "_raw": {
    "sourceFilePath": "35.md",
    "sourceFileName": "35.md",
    "sourceFileDir": ".",
    "contentType": "markdown",
    "flattenedPath": "35"
  },
  "type": "Post"
}