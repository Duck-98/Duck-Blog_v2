{
  "title": "next 14 폰트 레이아웃 쉬프트 해결하기",
  "date": "2023-12-15",
  "description": "next/font & layout shift",
  "tag": "React",
  "body": {
    "raw": "\n### next 14 폰트 레이아웃 쉬프트 해결하기\n\n#### Layout Shift?\n\n레이아웃 쉬프트란 웹 페이지의 렌더링 과정에서 발생하는 사용자 경험과 관련된 성능 지표 중 하나다. Core Web Vitals 중 하나로, Google에서 웹 페이지의 사용자 경험을 평가하는 데 사용되는 중요한 지표 중 하나다.\n\n레이아웃 쉬프트는 웹 페이지가 로드되는 동안 요소들의 위치가 변경되어 사용자 경험에 영향을 미치는 현상을 나타낸다. 사용자가 페이지를 열었을 때, 원치 않는 레이아웃의 변화가 발생하면 사용자가 의도한대로 상호작용하는 것을 방해할 수 있다.\n\n<br />\n\n레이아웃 쉬프트는 다음과 같은 상황에서 발생한다.\n\n1. 이미지의 크기를 지정하지 않고 로딩: 이미지가 로드되기 전에 해당 이미지의 크기를 명시적으로 지정하지 않으면, 이미지가 로드되면서 레이아웃이 변경될 수 있다.\n\n2. 동적으로 로드되는 콘텐츠: 페이지가 로드된 후에 JavaScript 또는 비동기적으로 로드되는 콘텐츠가 있다면, 이로 인해 레이아웃이 변할 수 있다.\n\n3. 폰트의 지연된 로딩: 페이지에 사용된 폰트가 로드되기 전에 기본 폰트로 표시되다가 폰트가 로드되면 레이아웃이 변할 수 있다.\n\nNext + tailwindcss를 이용해서 개발을 하고 있는 도중, 새로고침을 하게 되면 위 3번 폰트 레이아웃 쉬프트가 발생하고 있었다. 해당 폰트는 웹 폰트로 사용하고 있었다. 해당 레이아웃 쉬프트를 없애기 위해 구글링하던 도중, next 13부터 next font를 지원해주고 있었다. next/font를 사용하면 최적화할 수 있을 뿐만이 아니라 레이아웃 없이 최적으로 폰트를 로드할 수 있다고 해서 사용했다.\n\n**레이아웃 쉬프트 발생 화면**\n<Image src='/blog/36-1.gif' width='300' height={900}/>\n\n우선 기존 웹 폰트를 걷어내고, 로컬 폰트로 받아오기 위해서 기존 웹폰트 코드들을 삭제해줬다.\n\n```css\n@font-face {\n  font-family: 'SCoreDream';\n  font-weight: 100;\n  font-style: normal;\n  src: url(https://cdn.jsdelivr.net/gh/webfontworld/SCoreDream/SCoreDream1.woff2) format('woff2'), url(https://cdn.jsdelivr.net/gh/webfontworld/SCoreDream/SCoreDream1.woff)\n      format('woff');\n  font-display: swap;\n}\n```\n\n위 코드들을 삭제해줬다. 그리고 해당 폰트를 저장한 뒤 next app 라우터를 사용하기 때문에,\napp/fonts 폴더에 폰트들을 놓아줬다.\n\n그 후 layout.tsx에서 폰트 설정을 해줬다.\n**_ layout.tsx _**\n\n```js\nimport type { Metadata } from 'next';\nimport './globals.css';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { ToastContainer } from 'react-toastify';\nimport localFont from 'next/font/local';\n\nexport const metadata: Metadata = {\n  title: 'Petmunity',\n  description: '',\n};\n\nconst myFont = localFont({\n  src: [\n    {\n      path: './fonts/SCDream1.otf',\n      weight: '100',\n    },\n    {\n      path: './fonts/SCDream2.otf',\n      weight: '200',\n    },\n    {\n      path: './fonts/SCDream3.otf',\n      weight: '300',\n    },\n    {\n      path: './fonts/SCDream4.otf',\n      weight: '400',\n    },\n    {\n      path: './fonts/SCDream5.otf',\n      weight: '500',\n    },\n    {\n      path: './fonts/SCDream6.otf',\n      weight: '600',\n    },\n    {\n      path: './fonts/SCDream7.otf',\n      weight: '700',\n    },\n    {\n      path: './fonts/SCDream8.otf',\n      weight: '800',\n    },\n    {\n      path: './fonts/SCDream9.otf',\n      weight: '900',\n    },\n  ],\n  display: 'swap',\n  variable: '--font-scdream',\n});\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"ko\" className={`bg-gray-50 ${myFont.className} `}>\n      <body className=\"md:max-w-[375px] w-full relative m-auto min-h-screen bg-white p-0 font-sans lining-nums text-gray-900 outline-none\">\n        <div id=\"modal-root\" />\n        {children}\n        <ToastContainer position=\"top-right\" autoClose={5000} />\n      </body>\n    </html>\n  );\n}\n```\n\ntailwindcss를 사용하고 있기 때문에, variable로 폰트 변수 이름을 지정해줬다.\n\n**_ tailwind.config.ts _**\n\n```js\nconst config: Config = {\n  content: [\n    \"./src/pages/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./src/components/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./src/app/**/*.{js,ts,jsx,tsx,mdx}\",\n  ],\n  theme: {\n    fontFamily: {\n      sans: [\"var(--font-scdream)\"],\n    },\n    ... 생략\n```\n\n이런식으로 아까 만들어준 폰트 변수를 넣어주면 사용할 수 있게 된다!\n\n**_ 폰트 최적화 후 _**\n\n<Image src='/blog/36-2.gif' width='200' height={900}/>\n\n아까랑 다르게 폰트 레이아웃 쉬프트 현상이 사라졌다.\n",
    "code": "var Component=(()=>{var h=Object.create;var a=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var x=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),w=(e,n)=>{for(var o in n)a(e,o,{get:n[o],enumerable:!0})},s=(e,n,o,i)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let r of p(n))!g.call(e,r)&&r!==o&&a(e,r,{get:()=>n[r],enumerable:!(i=f(n,r))||i.enumerable});return e};var u=(e,n,o)=>(o=e!=null?h(m(e)):{},s(n||!e||!e.__esModule?a(o,\"default\",{value:e,enumerable:!0}):o,e)),y=e=>s(a({},\"__esModule\",{value:!0}),e);var l=x((v,c)=>{c.exports=_jsx_runtime});var S={};w(S,{default:()=>b,frontmatter:()=>C});var t=u(l()),C={title:\"next 14 \\uD3F0\\uD2B8 \\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8 \\uD574\\uACB0\\uD558\\uAE30\",date:new Date(17025984e5),description:\"next/font & layout shift\",tag:\"React\"};function d(e){let n=Object.assign({h3:\"h3\",h4:\"h4\",p:\"p\",ol:\"ol\",li:\"li\",strong:\"strong\",pre:\"pre\",code:\"code\"},e.components),{Image:o}=n;return o||D(\"Image\",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{children:\"next 14 \\uD3F0\\uD2B8 \\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8 \\uD574\\uACB0\\uD558\\uAE30\"}),`\n`,(0,t.jsx)(n.h4,{children:\"Layout Shift?\"}),`\n`,(0,t.jsx)(n.p,{children:\"\\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8\\uB780 \\uC6F9 \\uD398\\uC774\\uC9C0\\uC758 \\uB80C\\uB354\\uB9C1 \\uACFC\\uC815\\uC5D0\\uC11C \\uBC1C\\uC0DD\\uD558\\uB294 \\uC0AC\\uC6A9\\uC790 \\uACBD\\uD5D8\\uACFC \\uAD00\\uB828\\uB41C \\uC131\\uB2A5 \\uC9C0\\uD45C \\uC911 \\uD558\\uB098\\uB2E4. Core Web Vitals \\uC911 \\uD558\\uB098\\uB85C, Google\\uC5D0\\uC11C \\uC6F9 \\uD398\\uC774\\uC9C0\\uC758 \\uC0AC\\uC6A9\\uC790 \\uACBD\\uD5D8\\uC744 \\uD3C9\\uAC00\\uD558\\uB294 \\uB370 \\uC0AC\\uC6A9\\uB418\\uB294 \\uC911\\uC694\\uD55C \\uC9C0\\uD45C \\uC911 \\uD558\\uB098\\uB2E4.\"}),`\n`,(0,t.jsx)(n.p,{children:\"\\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8\\uB294 \\uC6F9 \\uD398\\uC774\\uC9C0\\uAC00 \\uB85C\\uB4DC\\uB418\\uB294 \\uB3D9\\uC548 \\uC694\\uC18C\\uB4E4\\uC758 \\uC704\\uCE58\\uAC00 \\uBCC0\\uACBD\\uB418\\uC5B4 \\uC0AC\\uC6A9\\uC790 \\uACBD\\uD5D8\\uC5D0 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE58\\uB294 \\uD604\\uC0C1\\uC744 \\uB098\\uD0C0\\uB0B8\\uB2E4. \\uC0AC\\uC6A9\\uC790\\uAC00 \\uD398\\uC774\\uC9C0\\uB97C \\uC5F4\\uC5C8\\uC744 \\uB54C, \\uC6D0\\uCE58 \\uC54A\\uB294 \\uB808\\uC774\\uC544\\uC6C3\\uC758 \\uBCC0\\uD654\\uAC00 \\uBC1C\\uC0DD\\uD558\\uBA74 \\uC0AC\\uC6A9\\uC790\\uAC00 \\uC758\\uB3C4\\uD55C\\uB300\\uB85C \\uC0C1\\uD638\\uC791\\uC6A9\\uD558\\uB294 \\uAC83\\uC744 \\uBC29\\uD574\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`,(0,t.jsx)(\"br\",{}),`\n`,(0,t.jsx)(n.p,{children:\"\\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8\\uB294 \\uB2E4\\uC74C\\uACFC \\uAC19\\uC740 \\uC0C1\\uD669\\uC5D0\\uC11C \\uBC1C\\uC0DD\\uD55C\\uB2E4.\"}),`\n`,(0,t.jsxs)(n.ol,{children:[`\n`,(0,t.jsxs)(n.li,{children:[`\n`,(0,t.jsx)(n.p,{children:\"\\uC774\\uBBF8\\uC9C0\\uC758 \\uD06C\\uAE30\\uB97C \\uC9C0\\uC815\\uD558\\uC9C0 \\uC54A\\uACE0 \\uB85C\\uB529: \\uC774\\uBBF8\\uC9C0\\uAC00 \\uB85C\\uB4DC\\uB418\\uAE30 \\uC804\\uC5D0 \\uD574\\uB2F9 \\uC774\\uBBF8\\uC9C0\\uC758 \\uD06C\\uAE30\\uB97C \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uC9C0\\uC815\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74, \\uC774\\uBBF8\\uC9C0\\uAC00 \\uB85C\\uB4DC\\uB418\\uBA74\\uC11C \\uB808\\uC774\\uC544\\uC6C3\\uC774 \\uBCC0\\uACBD\\uB420 \\uC218 \\uC788\\uB2E4.\"}),`\n`]}),`\n`,(0,t.jsxs)(n.li,{children:[`\n`,(0,t.jsx)(n.p,{children:\"\\uB3D9\\uC801\\uC73C\\uB85C \\uB85C\\uB4DC\\uB418\\uB294 \\uCF58\\uD150\\uCE20: \\uD398\\uC774\\uC9C0\\uAC00 \\uB85C\\uB4DC\\uB41C \\uD6C4\\uC5D0 JavaScript \\uB610\\uB294 \\uBE44\\uB3D9\\uAE30\\uC801\\uC73C\\uB85C \\uB85C\\uB4DC\\uB418\\uB294 \\uCF58\\uD150\\uCE20\\uAC00 \\uC788\\uB2E4\\uBA74, \\uC774\\uB85C \\uC778\\uD574 \\uB808\\uC774\\uC544\\uC6C3\\uC774 \\uBCC0\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`]}),`\n`,(0,t.jsxs)(n.li,{children:[`\n`,(0,t.jsx)(n.p,{children:\"\\uD3F0\\uD2B8\\uC758 \\uC9C0\\uC5F0\\uB41C \\uB85C\\uB529: \\uD398\\uC774\\uC9C0\\uC5D0 \\uC0AC\\uC6A9\\uB41C \\uD3F0\\uD2B8\\uAC00 \\uB85C\\uB4DC\\uB418\\uAE30 \\uC804\\uC5D0 \\uAE30\\uBCF8 \\uD3F0\\uD2B8\\uB85C \\uD45C\\uC2DC\\uB418\\uB2E4\\uAC00 \\uD3F0\\uD2B8\\uAC00 \\uB85C\\uB4DC\\uB418\\uBA74 \\uB808\\uC774\\uC544\\uC6C3\\uC774 \\uBCC0\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`]}),`\n`]}),`\n`,(0,t.jsx)(n.p,{children:\"Next + tailwindcss\\uB97C \\uC774\\uC6A9\\uD574\\uC11C \\uAC1C\\uBC1C\\uC744 \\uD558\\uACE0 \\uC788\\uB294 \\uB3C4\\uC911, \\uC0C8\\uB85C\\uACE0\\uCE68\\uC744 \\uD558\\uAC8C \\uB418\\uBA74 \\uC704 3\\uBC88 \\uD3F0\\uD2B8 \\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8\\uAC00 \\uBC1C\\uC0DD\\uD558\\uACE0 \\uC788\\uC5C8\\uB2E4. \\uD574\\uB2F9 \\uD3F0\\uD2B8\\uB294 \\uC6F9 \\uD3F0\\uD2B8\\uB85C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uC5C8\\uB2E4. \\uD574\\uB2F9 \\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8\\uB97C \\uC5C6\\uC560\\uAE30 \\uC704\\uD574 \\uAD6C\\uAE00\\uB9C1\\uD558\\uB358 \\uB3C4\\uC911, next 13\\uBD80\\uD130 next font\\uB97C \\uC9C0\\uC6D0\\uD574\\uC8FC\\uACE0 \\uC788\\uC5C8\\uB2E4. next/font\\uB97C \\uC0AC\\uC6A9\\uD558\\uBA74 \\uCD5C\\uC801\\uD654\\uD560 \\uC218 \\uC788\\uC744 \\uBFD0\\uB9CC\\uC774 \\uC544\\uB2C8\\uB77C \\uB808\\uC774\\uC544\\uC6C3 \\uC5C6\\uC774 \\uCD5C\\uC801\\uC73C\\uB85C \\uD3F0\\uD2B8\\uB97C \\uB85C\\uB4DC\\uD560 \\uC218 \\uC788\\uB2E4\\uACE0 \\uD574\\uC11C \\uC0AC\\uC6A9\\uD588\\uB2E4.\"}),`\n`,(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:\"\\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8 \\uBC1C\\uC0DD \\uD654\\uBA74\"})}),`\n`,(0,t.jsx)(o,{src:\"/blog/36-1.gif\",width:\"300\",height:900}),`\n`,(0,t.jsx)(n.p,{children:\"\\uC6B0\\uC120 \\uAE30\\uC874 \\uC6F9 \\uD3F0\\uD2B8\\uB97C \\uAC77\\uC5B4\\uB0B4\\uACE0, \\uB85C\\uCEEC \\uD3F0\\uD2B8\\uB85C \\uBC1B\\uC544\\uC624\\uAE30 \\uC704\\uD574\\uC11C \\uAE30\\uC874 \\uC6F9\\uD3F0\\uD2B8 \\uCF54\\uB4DC\\uB4E4\\uC744 \\uC0AD\\uC81C\\uD574\\uC92C\\uB2E4.\"}),`\n`,(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:\"language-css\",children:`@font-face {\n  font-family: 'SCoreDream';\n  font-weight: 100;\n  font-style: normal;\n  src: url(https://cdn.jsdelivr.net/gh/webfontworld/SCoreDream/SCoreDream1.woff2) format('woff2'), url(https://cdn.jsdelivr.net/gh/webfontworld/SCoreDream/SCoreDream1.woff)\n      format('woff');\n  font-display: swap;\n}\n`})}),`\n`,(0,t.jsx)(n.p,{children:`\\uC704 \\uCF54\\uB4DC\\uB4E4\\uC744 \\uC0AD\\uC81C\\uD574\\uC92C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uD574\\uB2F9 \\uD3F0\\uD2B8\\uB97C \\uC800\\uC7A5\\uD55C \\uB4A4 next app \\uB77C\\uC6B0\\uD130\\uB97C \\uC0AC\\uC6A9\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0,\napp/fonts \\uD3F4\\uB354\\uC5D0 \\uD3F0\\uD2B8\\uB4E4\\uC744 \\uB193\\uC544\\uC92C\\uB2E4.`}),`\n`,(0,t.jsxs)(n.p,{children:[`\\uADF8 \\uD6C4 layout.tsx\\uC5D0\\uC11C \\uD3F0\\uD2B8 \\uC124\\uC815\\uC744 \\uD574\\uC92C\\uB2E4.\n`,(0,t.jsx)(n.strong,{children:\"_ layout.tsx _\"})]}),`\n`,(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:\"language-js\",children:`import type { Metadata } from 'next';\nimport './globals.css';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { ToastContainer } from 'react-toastify';\nimport localFont from 'next/font/local';\n\nexport const metadata: Metadata = {\n  title: 'Petmunity',\n  description: '',\n};\n\nconst myFont = localFont({\n  src: [\n    {\n      path: './fonts/SCDream1.otf',\n      weight: '100',\n    },\n    {\n      path: './fonts/SCDream2.otf',\n      weight: '200',\n    },\n    {\n      path: './fonts/SCDream3.otf',\n      weight: '300',\n    },\n    {\n      path: './fonts/SCDream4.otf',\n      weight: '400',\n    },\n    {\n      path: './fonts/SCDream5.otf',\n      weight: '500',\n    },\n    {\n      path: './fonts/SCDream6.otf',\n      weight: '600',\n    },\n    {\n      path: './fonts/SCDream7.otf',\n      weight: '700',\n    },\n    {\n      path: './fonts/SCDream8.otf',\n      weight: '800',\n    },\n    {\n      path: './fonts/SCDream9.otf',\n      weight: '900',\n    },\n  ],\n  display: 'swap',\n  variable: '--font-scdream',\n});\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"ko\" className={\\`bg-gray-50 \\${myFont.className} \\`}>\n      <body className=\"md:max-w-[375px] w-full relative m-auto min-h-screen bg-white p-0 font-sans lining-nums text-gray-900 outline-none\">\n        <div id=\"modal-root\" />\n        {children}\n        <ToastContainer position=\"top-right\" autoClose={5000} />\n      </body>\n    </html>\n  );\n}\n`})}),`\n`,(0,t.jsx)(n.p,{children:\"tailwindcss\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, variable\\uB85C \\uD3F0\\uD2B8 \\uBCC0\\uC218 \\uC774\\uB984\\uC744 \\uC9C0\\uC815\\uD574\\uC92C\\uB2E4.\"}),`\n`,(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:\"_ tailwind.config.ts _\"})}),`\n`,(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:\"language-js\",children:`const config: Config = {\n  content: [\n    \"./src/pages/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./src/components/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./src/app/**/*.{js,ts,jsx,tsx,mdx}\",\n  ],\n  theme: {\n    fontFamily: {\n      sans: [\"var(--font-scdream)\"],\n    },\n    ... \\uC0DD\\uB7B5\n`})}),`\n`,(0,t.jsx)(n.p,{children:\"\\uC774\\uB7F0\\uC2DD\\uC73C\\uB85C \\uC544\\uAE4C \\uB9CC\\uB4E4\\uC5B4\\uC900 \\uD3F0\\uD2B8 \\uBCC0\\uC218\\uB97C \\uB123\\uC5B4\\uC8FC\\uBA74 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uAC8C \\uB41C\\uB2E4!\"}),`\n`,(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:\"_ \\uD3F0\\uD2B8 \\uCD5C\\uC801\\uD654 \\uD6C4 _\"})}),`\n`,(0,t.jsx)(o,{src:\"/blog/36-2.gif\",width:\"200\",height:900}),`\n`,(0,t.jsx)(n.p,{children:\"\\uC544\\uAE4C\\uB791 \\uB2E4\\uB974\\uAC8C \\uD3F0\\uD2B8 \\uB808\\uC774\\uC544\\uC6C3 \\uC26C\\uD504\\uD2B8 \\uD604\\uC0C1\\uC774 \\uC0AC\\uB77C\\uC84C\\uB2E4.\"})]})}function j(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(d,e)})):d(e)}var b=j;function D(e,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return y(S);})();\n;return Component;"
  },
  "_id": "36.md",
  "_raw": {
    "sourceFilePath": "36.md",
    "sourceFileName": "36.md",
    "sourceFileDir": ".",
    "contentType": "markdown",
    "flattenedPath": "36"
  },
  "type": "Post"
}